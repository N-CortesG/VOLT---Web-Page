---
import LanguageSwitcher from '@components/LanguageSwitcher.astro';
import socialLinks from '../../data/socialLinks';
import ThemeToggle from '../ThemeToggle';

export interface Props {
  currentPath: string;
  lang: 'es' | 'en';
  t: any;
}

const { currentPath, lang, t } = Astro.props;
const pathWithoutLang = currentPath.replace(/^\/(es|en)/, '') || '/';
---

<!-- Mobile Menu -->
<div
  id="mobile-menu"
  class="fixed top-[64px] left-0 right-0 mx-4 rounded-xl shadow-lg bg-background dark:bg-dark-background px-6 py-6 hidden opacity-0 translate-y-[-10px] transition-all duration-300 ease-in-out z-40 border border-line dark:border-dark-line"
>
  <nav aria-label="Menú móvil">
    <ul class="flex flex-col divide-y divide-line dark:divide-dark-line">
      <li>
        <a
          href={`/${lang}`}
          onclick="closeMenu()"
          class={`block px-4 py-3 rounded-md font-medium transition-colors duration-300 ${
            pathWithoutLang === '/'
              ? 'bg-yellow-light text-white dark:bg-dark-yellow-light'
              : 'hover:bg-yellow-light/10 dark:hover:bg-dark-yellow-light/10'
          }`}
        >
          {t.header.home}
        </a>
      </li>
      <li>
        <a
          href={`/${lang}/about`}
          class={`px-4 py-2 rounded-md font-medium whitespace-nowrap transition-colors duration-300 ${
            pathWithoutLang.startsWith('/about`')
              ? 'bg-yellow-light text-white dark:bg-dark-yellow-light'
              : 'hover:bg-yellow-light/20 dark:hover:bg-dark-yellow-light/20'
          }`}
        >
          {t.header.about}
        </a>
      </li>
      <li>
        <a
          href={`/${lang}/services`}
          onclick="closeMenu()"
          class={`block px-4 py-3 rounded-md font-medium transition-colors duration-300 ${
            pathWithoutLang.startsWith('/services')
              ? 'bg-yellow-light text-white dark:bg-dark-yellow-light'
              : 'hover:bg-yellow-light/10 dark:hover:bg-dark-yellow-light/10'
          }`}
        >
          {t.header.services}
        </a>
      </li>
      <li>
        <a
          href={`/${lang}/contact`}
          onclick="closeMenu()"
          class={`block px-4 py-3 rounded-md font-medium transition-colors duration-300 ${
            pathWithoutLang.startsWith('/contact')
              ? 'bg-yellow-light text-white dark:bg-dark-yellow-light'
              : 'hover:bg-yellow-light/10 dark:hover:bg-dark-yellow-light/10'
          }`}
        >
          {t.header.contact}
        </a>
      </li>
    </ul>

    <!-- Tema + Selector de idioma juntos -->
    <div class="mt-6 flex justify-center items-center gap-4">
      <ThemeToggle client:only="react" />
      <LanguageSwitcher lang={lang} />
    </div>

    <div class="flex justify-center mt-6">
      <a
        href={socialLinks.whatsapp}
        onclick="closeMenu()"
        class="inline-flex items-center gap-2 px-5 py-3 bg-green-light hover:bg-green-dark dark:bg-dark-green-light dark:hover:bg-dark-green-dark text-white rounded-md transition-colors shadow-md"
        target="_blank"
        rel="noopener noreferrer"
      >
        <svg
          xmlns="http://www.w3.org/2000/svg"
          class="w-5 h-5"
          fill="currentColor"
          viewBox="0 0 24 24"
        >
          <path
            d="M20.52 3.48A11.94 11.94 0 0012 0C5.37 0 .02 5.35 0 12a11.93 11.93 0 001.62 6L0 24l6.37-1.67a11.96 11.96 0 005.63 1.44c6.63 0 12-5.35 12-12 0-3.2-1.25-6.22-3.48-8.52zM12 22c-1.84 0-3.6-.5-5.15-1.45l-.37-.22-3.78.99 1-3.69-.24-.39A10.02 10.02 0 012 12c0-5.52 4.48-10 10-10s10 4.48 10 10-4.48 10-10 10zm5.2-7.54c-.29-.15-1.72-.85-1.98-.95-.27-.1-.47-.15-.67.15s-.77.95-.94 1.15c-.17.2-.34.22-.63.08-.29-.15-1.23-.45-2.35-1.43-.87-.78-1.45-1.74-1.62-2.03-.17-.3-.02-.46.13-.61.14-.14.29-.34.43-.5.14-.17.19-.29.29-.48.1-.19.05-.36-.02-.5-.07-.14-.67-1.61-.91-2.21-.24-.57-.48-.5-.66-.51-.17-.01-.36-.01-.55-.01s-.5.07-.76.36c-.26.29-1 1-.98 2.43s1.03 2.82 1.17 3.01c.14.2 2.03 3.1 4.93 4.35.69.3 1.22.48 1.64.61.69.22 1.31.19 1.8.11.55-.08 1.72-.7 1.96-1.37.24-.67.24-1.24.17-1.37-.07-.13-.26-.21-.55-.36z"
          ></path>
        </svg>
        Whatsapp
      </a>
    </div>
  </nav>
</div>
